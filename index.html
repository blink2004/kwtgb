<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel="shortcut icon" href="assets/favicon.ico" type="image/x-icon"/>
    <link rel="icon" href="assets/favicon.ico" type="image/x-icon"/>
    <title>Kyiv Weather Map</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="https://code.jquery.com/qunit/qunit-2.24.1.css">
    <!-- Make sure you put this AFTER Leaflet's CSS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <!-- Telegram mini app Script -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <!-- End of Telegram mini app Script -->

    <!-- jQuery Script -->
    <script type="text/javascript">
        // –û–±—ä—è–≤–ª—è–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
        const MIN_COUNT_SYMBOLS_FOR_REPORT_MSG = 5;
        const MAX_COUNT_SYMBOLS_FOR_REPORT_MSG = 255;

        // –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        let userSettings = {
            'currentLang': 'ru'
        };

        const i18n = {
            'en' : [
                // {'':''},
                // {'':''},
                {'MIN_SYMBOLS': '–í–≤–µ–¥–∏—Ç–µ —Ö–æ—Ç—è –±—ã 5 —Å–∏–º–≤–æ–ª–æ–≤'},
                // {'':''},
            ],
            'ru' : [
                {
                    'OK_BTN': 'OK',
                    'ADD_BTN': '–î–æ–±–∞–≤–∏—Ç—å',
                    'CANCEL_BTN': '–û—Ç–º–µ–Ω–∏—Ç—å',
                    'MIN_COUNT_SYMBOLS_FOR_REPORT_MSG': '–í–≤–µ–¥–∏—Ç–µ —Ö–æ—Ç—è –±—ã 5 —Å–∏–º–≤–æ–ª–æ–≤',
                    'MAX_COUNT_SYMBOLS_FOR_REPORT_MSG': '–ü—Ä–µ–≤—ã—à–µ–Ω–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –¥–æ–ø—É—Å—Ç–∏–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º–≤–æ–ª–æ–≤',
                    'EVENT_TYPE': {
                        1: '–°–∏–Ω–∏–µ',
                        2: '–ó–µ–ª—ë–Ω—ã–µ',
                        3: '–°–æ–ª–Ω–µ—á–Ω–æ',
                        4: '–ë–ª–æ–∫-–ø–æ—Å—Ç',
                    },
                    'EVENT_TYPE_IS_NOT_SELECTED': '–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–±—Ä–∞—Ç—å —Ç–∏–ø —Å–æ–±—ã—Ç–∏—è',
                    'HEADER_ADDING_REPORT': '–î–æ–±–∞–≤–ª–µ–Ω–∏–µ',
                    'REPORT_DESCRIPTION_TEXT_LENGTH_NOT_CORRECT': '–°–æ–æ–±—â–µ–Ω–∏—è –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ ' + MIN_COUNT_SYMBOLS_FOR_REPORT_MSG + ' –∏ –Ω–µ –±–æ–ª–µ–µ ' + MAX_COUNT_SYMBOLS_FOR_REPORT_MSG + ' —Å–∏–º–≤–æ–ª–æ–≤',
                }
            ],
            'ua' : []
        };

        var isAddNewMarketBtnClicked = false;
        var isSettingsBtnClicked = false;

        function setPressedBtn(el, status) {
            if ( status ) {
                $(el).css('background-color', 'lightgreen');
            } else {
                $(el).css('background-color', 'white');
            }
        }

        function setTranslations() {
            $('#reportInfoModal > .text-header-h2').text(i18n[userSettings.currentLang][0].HEADER_ADDING_REPORT);
        }

        // $(document).ready(function() {
        $(function() {
            // –ü—Ä—è—á–µ–º –≤—Å—ë –ª–∏—à–Ω–µ–µ
            $('#reportInfoModal, #reportInfoDetailsPopup, #setMapMarkerHint, #settingsModalBox, #preloader, .spinner').hide();

            $("#selectedMarkerTypeDesc").text("–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø —Å–æ–±—ã—Ç–∏—è");

            // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É "–î–æ–±–∞–≤–∏—Ç—å –º–∞—Ä–∫–µ—Ä"
            $("#addNewMarkerBtn").on("click", function (e) {
                if ( isAddNewMarketBtnClicked ) {
                    setPressedBtn($(this), false);
                    $("#settingsBtn").show(); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–ù–∞—Å—Ç—Ä–æ–π–∫–∏"
                    $("#setMapMarkerHint").hide(); // –°–∫—Ä—ã–≤–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –æ –¥–µ–π—Å—Ç–≤–∏—è—Ö
                    Telegram.WebApp.MainButton.show(); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≥–ª–∞–≤–Ω—É—é –∫–Ω–æ–ø–∫—É Telegram
                    Telegram.WebApp.SecondaryButton.hide(); // –°–∫—Ä—ã–≤–∞–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∫–Ω–æ–ø–∫—É Telegram
                } else {
                    setPressedBtn($(this), true);
                    Telegram.WebApp.MainButton.setParams({ text: i18n[userSettings.currentLang][0].ADD_BTN });
                    Telegram.WebApp.SecondaryButton.setParams({ text: i18n[userSettings.currentLang][0].CANCEL_BTN });
                    $("#settingsBtn").hide(); // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–ù–∞—Å—Ç—Ä–æ–π–∫–∏"
                    $("#setMapMarkerHint").show(); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –æ –¥–µ–π—Å—Ç–≤–∏—è—Ö
                    $("#reportInfoDetailsPopup").hide(); // –°–∫—Ä—ã–≤–∞–µ–º –¥–µ—Ç–∞–ª–∏ —Ç–æ—á–∫–∏, –µ—Å–ª–∏ –±—ã–ª–∞ –æ—Ç–∫—Ä—ã—Ç–∞
                    Telegram.WebApp.MainButton.hide(); // –ü—Ä—è—á–µ–º –≥–ª–∞–≤–Ω—É—é –∫–Ω–æ–ø–∫—É Telegram
                    Telegram.WebApp.SecondaryButton.setParams({ text: i18n[userSettings.currentLang][0].CANCEL_BTN });
                    Telegram.WebApp.SecondaryButton.show(); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω—É—é –∫–Ω–æ–ø–∫—É Telegram
                }
                isAddNewMarketBtnClicked = !isAddNewMarketBtnClicked; // –ó–∞–ø–æ–º–∏–Ω–∞–µ–º —Å—Ç–∞—Ç—É—Å –∫–Ω–æ–ø–∫–∏
            });

            // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É "–ù–∞—Å—Ç—Ä–æ–π–∫–∏"
            $("#settingsBtn").on("click", function(e) {
                // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ —ç—Ç–æ–≥–æ –ø—ã—Ç–∞–ª—Å—è –¥–æ–±–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ –∏–ª–∏ –µ—â—ë —á—Ç–æ-—Ç–æ - –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º
                if ( isAddNewMarketBtnClicked ) {
                    e.preventDefault();
                    return;
                }

                // –ö–Ω–æ–ø–∫–∞ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–∂–µ –±—ã–ª–∞ –Ω–∞–∂–∞—Ç–∞ -> –≤—ã—Ö–æ–¥–∏–º, –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å—ë
                if ( isSettingsBtnClicked ) {
                    setPressedBtn($(this), false);
                    $("#map").show();
                    $("#addNewMarkerBtn").show();
                    Telegram.WebApp.MainButton.show();
                } else {
                    setPressedBtn($(this), true);
                    $("#map").hide();
                    $("#addNewMarkerBtn").hide();
                    $("#reportInfoDetailsPopup").hide(); // –°–∫—Ä—ã–≤–∞–µ–º –¥–µ—Ç–∞–ª–∏ —Ç–æ—á–∫–∏, –µ—Å–ª–∏ –±—ã–ª–∞ –æ—Ç–∫—Ä—ã—Ç–∞
                    if ( Telegram.WebApp.MainButton.isVisible )
                        Telegram.WebApp.MainButton.hide();
                }
                isSettingsBtnClicked = !isSettingsBtnClicked;
            });

            // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–∏–ª –¥–∞–Ω–Ω—ã–µ
            // $("#reportInfoBoxSendReport, #sendReportBtn").on("click", function(e) {
            $("#sendReportBtn").on("click", function(e) {
                // window.navigator.vibrate(200);

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç–∏ —Ñ–æ—Ä–º—ã
                if ( $('input[name="event_type"]:checked').val() === undefined ) {
                    e.preventDefault();
                    Telegram.WebApp.showAlert(i18n[userSettings.currentLang][0].EVENT_TYPE_IS_NOT_SELECTED);

                    return false;
                }

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —É–∫–∞–∑–∞–Ω –ª–∏ —Ç–µ–∫—Å—Ç
                let reportDescriptionText = $('#reportDescription').val();
                if ( (reportDescriptionText.length < MIN_COUNT_SYMBOLS_FOR_REPORT_MSG) || (reportDescriptionText.length > MAX_COUNT_SYMBOLS_FOR_REPORT_MSG) ) {
                    e.preventDefault();
                    Telegram.WebApp.showAlert(i18n[userSettings.currentLang][0].REPORT_DESCRIPTION_TEXT_LENGTH_NOT_CORRECT);
                    $('#reportDescription').focus();

                    return false;
                }

                // $("#preloader, .spinner").fadeIn("slow");
                $("#preloader, .spinner").show();

                $.ajax({
                    method: 'POST',
                    url: '/api/markers/add',
                    data: {
                        event_type: $('input[name="event_type"]:checked').val(),
                        description: $('#reportDescription').val()
                    },
                    success: function(data, textStatus, jqXHR) {
                        Telegram.WebApp.showAlert("–°–æ–±—ã—Ç–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –∏ —Å–∫–æ—Ä–æ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—Å—è –Ω–∞ –∫–∞—Ä—Ç–µ. –°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∫–ª–∞–¥! üôå");
                        Telegram.WebApp.MainButton.show();
                        // alert("–°–æ–±—ã—Ç–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –∏ —Å–∫–æ—Ä–æ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—Å—è –Ω–∞ –∫–∞—Ä—Ç–µ. –°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∫–ª–∞–¥! üôå");
                    }
                }).fail(function( jqXHR, textStatus, errorThrown ) {
                    Telegram.WebApp.showAlert('–ù–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –Ω–µ–º–Ω–æ–≥–æ –ø–æ–∑–∂–µ');
                    // alert('–ù–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –Ω–µ–º–Ω–æ–≥–æ –ø–æ–∑–∂–µ');
                }).done(function(data) {
                    console.log(data);
                });

                // alert("–°–æ–±—ã—Ç–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –∏ —Å–∫–æ—Ä–æ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—Å—è –Ω–∞ –∫–∞—Ä—Ç–µ. –°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∫–ª–∞–¥! üôå");
                // Telegram.WebApp.showAlert("–°–æ–±—ã—Ç–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –∏ —Å–∫–æ—Ä–æ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—Å—è –Ω–∞ –∫–∞—Ä—Ç–µ. –°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∫–ª–∞–¥! üôå");

                // $("#preloader, .spinner").fadeOut("slow");
                $("#preloader, .spinner").hide();

                map.removeLayer(marker);        // –£–¥–∞–ª—è–µ–º –º–∞—Ä–∫–µ—Ä, –µ—Å–ª–∏ –æ–Ω –±—ã–ª –¥–æ–±–∞–≤–ª–µ–Ω –Ω–∞ –∫–∞—Ä—Ç—É
                $("#reportInfoModal").hide();   // –ü—Ä—è—á–µ–º –ø–∞–Ω–µ–ª—å —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –º–µ—Ç–∫–µ
                $("#topPanel").show();          // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤–µ—Ä—Ö–Ω—é—é –ø–∞–Ω–µ–ª—å
                $("form")[0].reset();           // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã
                $("#settingsBtn").show();       // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–ù–∞—Å—Ç—Ä–æ–π–∫–∏"
                $("#setMapMarkerHint").hide();  // –ü—Ä—è—á–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É –æ–± —É—Å—Ç–∞–Ω–æ–≤–∫–µ –º–∞—Ä–∫–µ—Ä–∞
                $("#selectedMarkerTypeDesc").text("–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø —Å–æ–±—ã—Ç–∏—è");

                // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–Ω–æ–ø–∫–∏ Telegram
                Telegram.WebApp.SecondaryButton.hide();
                Telegram.WebApp.MainButton.show();
            });

            // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∞–ª –æ—Ç–º–µ–Ω–∞ –¥–ª—è –æ–∫–Ω–∞ —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
            $("#reportInfoBoxCancelIconBtn, #reportInfoBoxCancelBtn").on("click", function(e) {
                e.preventDefault();

                map.removeLayer(marker);        // –£–¥–∞–ª—è–µ–º –º–∞—Ä–∫–µ—Ä, –µ—Å–ª–∏ –æ–Ω –±—ã–ª –¥–æ–±–∞–≤–ª–µ–Ω –Ω–∞ –∫–∞—Ä—Ç—É
                $("#reportInfoModal").hide();   // –ü—Ä—è—á–µ–º –ø–∞–Ω–µ–ª—å —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –º–µ—Ç–∫–µ
                $("#topPanel").show();          // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤–µ—Ä—Ö–Ω—é—é –ø–∞–Ω–µ–ª—å
                $("form")[0].reset();           // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã
                $("#settingsBtn").show();       // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–ù–∞—Å—Ç—Ä–æ–π–∫–∏"
                $("#setMapMarkerHint").hide();  // –ü—Ä—è—á–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É –æ–± —É—Å—Ç–∞–Ω–æ–≤–∫–µ –º–∞—Ä–∫–µ—Ä–∞
                $("#selectedMarkerTypeDesc").text("–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø —Å–æ–±—ã—Ç–∏—è");

                Telegram.WebApp.MainButton.show();
            });

            // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∞–ª –∏–∫–æ–Ω–∫—É –ó–∞–∫—Ä—ã—Ç—å –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
            $(".cancel-btn").on("click", function(e) {
                $(this).parent(".modal-window").hide();
                Telegram.WebApp.SecondaryButton.hide();
                Telegram.WebApp.MainButton.setParams({ text: i18n[userSettings.currentLang][0].ADD_BTN });
            });

            // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∞–ª –∏–∫–æ–Ω–∫—É –ù–∞–∑–∞–¥ –≤ –æ–∫–Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
            $("#settingsModalBox > .back-btn").on("click", function(e) {
                // $(this).parent(".modal-window").hide();
                // $("#map").show();
                $("#settingsBtn").trigger("click");
                if ( !Telegram.WebApp.MainButton.isVisible ) {
                    Telegram.WebApp.MainButton.show();
                }
            });

            // –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ–∫—Å—Ç —É—Ç–æ—á–Ω–µ–Ω–∏—è –ø—Ä–∏ –≤—ã–±–æ—Ä–µ —á–µ–∫–±–æ–∫—Å–∞
            $(".radiobox").on("click", function(e) {
                // alert($(this).find("img").prop("alt")); // –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –¥–≤–∞–∂–¥—ã!!!
                $("#selectedMarkerTypeDesc").text( $(this).find("img").prop("alt") );
            });

            setTranslations();

            // –ê–Ω–æ–Ω–∏–º–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≤–Ω—É—Ç—Ä–∏ jQuery
            (function(){
                // Init TWA
                Telegram.WebApp.ready();

                // Event occurs whenever theme settings are changed in the user's Telegram app (including switching to night mode).
                Telegram.WebApp.onEvent('themeChanged', function () {
                    document.documentElement.className = Telegram.WebApp.colorScheme;
                });

                Telegram.WebApp.onEvent('themeChanged', function () {
                    document.body.setAttribute('style', '--bg-color:' + Telegram.WebApp.backgroundColor);
                });

                // Show main button
                Telegram.WebApp.MainButton.setParams({
                    text: i18n[userSettings.currentLang][0].ADD_BTN
                });

                // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏—è –ø–æ –Ω–∞–∂–∞—Ç–∏—é –Ω–∞–∂–∞—Ç–∏—é
                Telegram.WebApp.MainButton.onClick( function(){
                    if ( isAddNewMarketBtnClicked ) {
                        Telegram.WebApp.showAlert('DEBUG: –ù–∞–∂–∞—Ç–æ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä')
                        $('#sendReportBtn').trigger('click');

                        return;
                    }

                    // Telegram.WebApp.showAlert('Main Button was clicked')
                    $("#addNewMarkerBtn").trigger("click");
                });

                Telegram.WebApp.SecondaryButton.onClick( function(e){
                    if ( isAddNewMarketBtnClicked ) {
                        Telegram.WebApp.showAlert('DEBUG: –ù–∞–∂–∞—Ç–æ –¥–ª—è –æ—Ç–º–µ–Ω—ã –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä')
                        $('#reportInfoBoxCancelBtn').trigger('click');

                        e.preventDefault();
                    }
                });

                Telegram.WebApp.MainButton.show();

                // Function to call showPopup API
                function showPopup() {
                    Telegram.WebApp.showPopup({
                        title: 'Title',
                        message: 'Some message',
                        buttons: [
                            {id: 'link', type: 'default', text: 'Open ton.org'},
                            {type: 'cancel'},
                        ]
                    }, function (btn) {
                        if (btn === 'link') {
                            Telegram.WebApp.openLink('https://ton.org/');
                        }
                    });
                };

                // Function to toggle main TWA button
                function toggleMainButton() {
                    if (Telegram.WebApp.MainButton.isVisible) {
                        Telegram.WebApp.MainButton.hide();
                    } else {
                        Telegram.WebApp.MainButton.show();
                    }
                };

                Telegram.WebApp.setHeaderColor('secondary_bg_color');

                // Telegram.WebApp.onEvent('viewportChanged', setViewportData);
            })(jQuery);

            placeMarkersOnMap(markersArr);
        });
    </script>
</head>
<body>
    <!-- Preloader -->
    <div id="preloader"></div>
<!--        <img src="./assets/preloader.gif" width="30" height="20" alt="Preloading image..." style="display: none;" />-->
    <div class="spinner"></div>


    <!-- Map -->
    <div id="map"></div>

    <!-- Top panel -->
    <div id="topPanel">
        <input type="button" class="btn-rounded" id="settingsBtn" value="" />
        <input type="button" class="btn-rounded" id="addNewMarkerBtn" value="" />
    </div>

    <span id="setMapMarkerHint">–£–∫–∞–∂–∏—Ç–µ –º–µ—Å—Ç–æ –Ω–∞ –∫–∞—Ä—Ç–µ</span>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏—è –æ —Å–æ–±—ã—Ç–∏–∏ -->
    <div id="reportInfoModal" class="modal-window">
        <span class="text-header-h2"></span>
        <input type="button" class="cancel-btn btn-rounded" id="reportInfoBoxCancelIconBtn" value="" />
<!--        <input type="button" class="btn-rounded check-btn" id="reportInfoBoxSendReport" value="" />-->
        <div class="clear"></div>
        <form name="" method="post" enctype="multipart/form-data">
            <div>
                <div class="radiobox">
                    <input type="radio" id="sun" name="event_type" />
                    <label for="sun"><img src="./assets/sun.png" alt="–°–æ–ª–Ω–µ—á–Ω–æ" height="32" width="32" /></label>
                </div>
                <div class="radiobox">
                    <input type="radio" id="post" name="event_type" />
                    <label for="post"><img src="./assets/stop_control.png" alt="–ë–ª–æ–∫–ø–æ—Å—Ç" height="32" width="32" /></label>
                </div>
                <div class="radiobox">
                    <input type="radio" id="blue" name="event_type" />
                    <label for="blue"><img src="./assets/police_one.png" alt="–°–∏–Ω–∏–µ" height="32" width="32" /></label>
                </div>
                <div class="radiobox">
                    <input type="radio" id="green" name="event_type" />
                    <label for="green"><img src="./assets/icons8-soldiers-64.png" alt="–ó–µ–ª—ë–Ω—ã–µ" height="32" width="32" /></label>
                </div>
            </div>
            <div class="clear"></div>
            <div id="selectedMarkerTypeDesc">&nbsp;</div>
            <textarea name="description" id="reportDescription" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –Ω–µ –º–µ–Ω–µ–µ 5 —Å–∏–º–≤–æ–ª–æ–≤"></textarea><br />
<!--            <input type="file" name="media" /><br /><br />-->
<!--            <input type="submit" name="save" value="Save" />-->
            <button id="reportInfoBoxCancelBtn">–û—Ç–º–µ–Ω–∞</button>
            <button class="btn-ok" id="sendReportBtn">–î–æ–±–∞–≤–∏—Ç—å</button>
        </form>
    </div>

    <!-- Marker tooltip -->
    <div id="reportInfoDetailsPopup" class="modal-window">
        <input type="button" class="cancel-btn btn-rounded" id="" value="" />
<!--        <table>
            <tr>
                <td colspan="2">
                    <span class="icon"><img src="assets/icons8-soldiers-64.png" alt="–ó–µ–ª—ë–Ω—ã–µ" width="32" height="32" /></span>
                </td>
            </tr>
            <tr>
                <td>
                    <span class="time">11:57</span>
                </td>
                <td>
                    <span class="status">–ó–µ–ª—ë–Ω—ã–µ</span>
                </td>
            </tr>
        </table>-->
        <table>
            <tr>
                <td>
                    <span class="icon"><img src="assets/icons8-soldiers-64.png" alt="–ó–µ–ª—ë–Ω—ã–µ" width="32" height="32" /></span>
                </td>
                <td>
                    <div class="time">11:57</div>
                    <div class="status">–ó–µ–ª—ë–Ω—ã–µ</div>
                </td>
            </tr>
        </table>
        <div class="description">2 —Å–∏–Ω–∏—Ö, 2 –∑–µ–ª—ë–Ω—ã—Ö. –ì—É–ª—è–ª–∏ –ø–æ –Ω–∞–±–µ—Ä–µ–∂–Ω–æ–π</div>
        <div id="reportInfoDetailsDescription"></div>
        <div id="reportInfoDetailsMedia"></div>
        <div id="reportInfoDetailsPopupRatingBlock">
            <button class="btn-rounded like"></button>
            <span id="rating">5</span>
            <button class="btn-rounded dislike"></button>
        </div>
    </div>

    <!-- –û–∫–Ω–æ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
    <div id="settingsModalBox" class="modal-window">
<!--        <input type="button" class="cancel-btn btn-rounded" id="" value="" />-->
        <button class="back-btn"><</button>
        <span class="h2">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
        <div>
            –ë—É–¥—É—Ç –ø–æ–∑–∂–µ...
        </div>
    </div>


    <!-- Map Script -->
    <script type="text/javascript">
        var markersArr_tmp = [
            {
                'id': 2154181354,
                'time': '6:55',
                'type': 4,
                'lat': 50.571389,
                'lng': 30.490361,
                'rating': -2,
                'myReaction': 'l',
                'desc': 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin non luctus ipsum. Praesent fringilla libero sapien, ut porttitor est efficitur ut. Cras convallis gravida nisl sit amet pulvinar. Morbi in blandit ipsum. Aliquam porta urna vel ante consectetur tincidunt',
                'media': [
                    {
                        'typeOfMedia': 1,
                        'mediaUrl': ''
                    }
                ],
                'comments': [
                    {
                        'id': 513435435,
                        'userPhoto': '',
                        'userName': '',
                        'text': '',
                    }
                ]
            },
            {
                'id': 2154181354,
                'time': '12:57',
                'type': 2,
                'lat': 50.455683,
                'lng': 30.445903,
                'rating': 0,
                'myReaction': 'd',
                'desc': 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin non luctus ipsum. Praesent fringilla libero sapien, ut porttitor est efficitur ut. Cras convallis gravida nisl sit amet pulvinar. Morbi in blandit ipsum. Aliquam porta urna vel ante consectetur tincidunt',
                'media': [
                    {
                        'typeOfMedia': 1,
                        'mediaUrl': ''
                    }
                ],
                'comments': [
                    {
                        'id': 513435435,
                        'userPhoto': '',
                        'userName': '',
                        'text': '',
                    }
                ]
            },
            {
                'id': 2154181354,
                'time': '17:14',
                'type': 3,
                'lat': 50.401146,
                'lng': 30.634612,
                'rating': 8,
                'myReaction': '',
                'desc': 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin non luctus ipsum. Praesent fringilla libero sapien, ut porttitor est efficitur ut. Cras convallis gravida nisl sit amet pulvinar. Morbi in blandit ipsum. Aliquam porta urna vel ante consectetur tincidunt',
                'media': [],
                'comments': []
            }
        ];
        var markersArr = [
            {
                "id": 16,
                "type": 3,
                "lat": 50.931,
                "lng": 30.816,
                "desc": "–°–æ–ª–Ω–µ—á–Ω–æ",
                "time": "04:03"
            },
            {
                "id": 17,
                "type": 2,
                "lat": 50.505841070711,
                "lng": 30.510124862194,
                "desc": "–ü–æ —ñ–≤–∞—Å—é–∫–∞ —ó—Ö–∞–ª–∞ –º–∞—à–∏–Ω–∞ –∫–æ–º—Å–µ—Ä–≤—ñ—Å–∞, –∑–≤–µ—Ä–Ω—É–ª–∞ –Ω–∞ –∫—ñ–ª—å—Ü—ñ –±—ñ–ª—è –ø–∞—Ä–∫–∞ –ù–∞—Ç–∞–ª–∫–∞ —É –¥–≤–æ—Ä–∏, –æ–±–µ—Ä–µ–∂–Ω–æ",
                "time": "16:03"
            },
            {
                "id": 18,
                "type": 4,
                "lat": 50.353771554933,
                "lng": 30.294966101646,
                "desc": "–ë–æ—è—Ä–∫–∞ –ú—ñ–∫–∞ 7:16 –≥–æ—Ç—É—é—Ç—å—Å—è",
                "time": "16:05"
            },
            {
                "id": 19,
                "type": 4,
                "lat": 50.365325327746,
                "lng": 30.415241718292,
                "desc": "–ö—É—Ä–≥–∞–Ω–Ω–æ–≤–∞/–ö–∞—à—Ç–∞–Ω–æ–≤–∞ –ì–∞—Ç–Ω–µ —Å–∏–Ω—ñ –æ–±–æ—Ä–æ—Ç–Ω—ñ –Ω–∞ –ø–æ–ª—é–≤–∞–Ω–Ω—ñ",
                "time": "16:06"
            },
            {
                "id": 20,
                "type": 2,
                "lat": 50.387015275826,
                "lng": 30.382261276245,
                "desc": "–í–∏—à–Ω–µ–≤–µ,–ß–æ—Ä–Ω–æ–≤–æ–ª–∞ –∫–æ—Ä–∏—á–Ω–µ–≤–∏–π –¥–æ–±–ª–æ",
                "time": "16:10"
            },
            {
                "id": 21,
                "type": 1,
                "lat": 50.411314021866,
                "lng": 30.549266338348,
                "desc": "–ë–æ–π—á—É–∫–∞ 18-22 - –±–µ–ª—ã–π –ø–æ–ª–∏—Ü–µ–π—Å–∫–∏–π –¥–∞—Å—Ç–µ—Ä, üåà –≤—ã–ø—Ä—ã–≥–∏–≤–∞—é—Ç –Ω–∞ —Ö–æ–¥—É. 7:15",
                "time": "16:11"
            },
            {
                "id": 22,
                "type": 1,
                "lat": 50.442255848879,
                "lng": 30.642414093018,
                "desc": "–ü–µ—Ä–µ—Ö—Ä–µ—Å—Ç—è –ê–∑–µ—Ä–±–∞–π–¥–∂–∞–Ω—Å—å–∫–æ—ó –ì–Ω–∞—Ç–∞ –•–æ—Ç–∫–µ–≤–∏—á–∞ —Å–∏–Ω—ñ –±–µ–∑ –∑–µ–ª–µ–Ω–∏—Ö –∑—É–ø–∏–Ω–∏–ª–∏ –∞–≤—Ç–æ",
                "time": "16:12"
            },
            {
                "id": 23,
                "type": 1,
                "lat": 50.426346606157,
                "lng": 30.614712238312,
                "desc": "–ë–µ—Ä–µ–∑–Ω—è–∫—ñ–≤—Å—å–∫–∞ 24. –ø–æ –¥–≤–æ—Ä–∞—Ö —ó–∑–¥—è—Ç—å —Å–∏–Ω—ñ! 6:50",
                "time": "16:12"
            },
            {
                "id": 24,
                "type": 3,
                "lat": 50.553668572618,
                "lng": 30.292380452156,
                "desc": "–ö–ü –í–∞—Ä—à–∞–≤–∫–∞ ,–ì–æ—Å—Ç–æ–º–µ–ª—å –Ω–∞ 7.20 —á–∏—Å—Ç–æ –≤ –æ–±–µ —Å—Ç–æ—Ä–æ–Ω—ã.",
                "time": "16:14"
            },
            {
                "id": 25,
                "type": 3,
                "lat": 50.403033467413,
                "lng": 30.68466424942,
                "desc": "–ë–ü –ë–æ—Ä–∏—Å–ø—ñ–ª—å—Å—å–∫–∞ 7:15",
                "time": "16:14"
            },
            {
                "id": 26,
                "type": 3,
                "lat": 50.431103537958,
                "lng": 30.646448135376,
                "desc": "–ñ–î –î–∞—Ä–Ω–∏—Ü—è, –ü—Ä–∏–≤–æ–∫–∑–∞–ª—å–Ω–∞ 7:20",
                "time": "16:17"
            },
            {
                "id": 27,
                "type": 2,
                "lat": 50.424449851387,
                "lng": 30.532250404358,
                "desc": "–ü—Ä–∏–π–º–∞—é—Ç—å .–ö—É–ø–∞ –∑–µ–ª–µ–Ω–∏—Ö",
                "time": "16:32"
            },
            {
                "id": 28,
                "type": 2,
                "lat": 50.484674841151,
                "lng": 30.633380413055,
                "desc": "–ö—É–±–∞–Ω—Å—å–∫–æ—ó –£–∫—Ä–∞—ó–Ω–∏ 22, –∂–æ—Ä—Å—Ç–∫–æ –ø–∞–∫—É—é—Ç—å —Ö–ª–æ–ø—Ü—è",
                "time": "16:33"
            },
            {
                "id": 29,
                "type": 2,
                "lat": 50.488067536091,
                "lng": 30.498003959656,
                "desc": "–º—ñ–∂ –û–±–æ–ª–æ–Ω—å —ñ –ü–æ—á–∞–π–Ω–∞ –¥–æ—â –Ω–∞ –ø—ñ—à–æ—Ö–æ–¥—ñ–≤",
                "time": "16:34"
            },
            {
                "id": 30,
                "type": 2,
                "lat": 50.489982219164,
                "lng": 30.495938658714,
                "desc": "–ü–µ—Ç—Ä–æ–≤–∫–∞ –±—ñ–ª—è –¢–†–¶ –ì–æ—Ä–æ–¥–æ–∫ –Ω–∞ –≤–∏—Ö–æ–¥—ñ –¥ –ø—ñ–¥–∑–µ–º–Ω–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥—É 2 –æ–ª–∏–≤–∫–∏ —ñ –±–∞–∫–ª–∞–∂–∞–Ω –ª–æ–≤–ª—è—Ç—å –ª—é–¥–µ–π –æ–±–µ—Ä–µ–∂–Ω–æ...",
                "time": "17:01"
            },
            {
                "id": 31,
                "type": 4,
                "lat": 50.504447343132,
                "lng": 30.438845157623,
                "desc": "–ü–µ—Ä–µ—Ö—Ä–µ—Å—Ç—è –ø—Ä.–°–≤–æ–±–æ–¥–∏ –Ñ–≤—Ä–æ–ø–µ–π—Å—å–∫–æ–≥–æ —Å–æ—é–∑—É –≥–æ—Ç—É—é—Ç—å –±–ª–æ–∫–ø–æ—Å—Ç",
                "time": "17:02"
            },
            {
                "id": 32,
                "type": 4,
                "lat": 50.401010973434,
                "lng": 30.681204199791,
                "desc": "–ë–æ—Ä—Ç–Ω–∏—á—ñ: –ø–æ–≤–æ—Ä–æ—Ç –Ω–∞ –∫–æ–ª–µ–∫—Ç–æ—Ä–Ω—É –∑—É–ø–∏–Ω—è—é—Ç—å –≤ –¥–≤—ñ —Å—Ç–æ—Ä–æ–Ω–∏ 7:50",
                "time": "17:04"
            },
            {
                "id": 33,
                "type": 2,
                "lat": 50.39522339426,
                "lng": 30.648011863232,
                "desc": "–í–∏—à–Ω—è–∫–æ–≤—Å–∫–∞—è 10 –≤—ã—Å–º–∞—Ç—Ä–∏–≤–∞—é —Å–∏–Ω–∏–µ –∏ –∑–µ–ª—ë–Ω—ã–µ",
                "time": "17:07"
            },
            {
                "id": 34,
                "type": 3,
                "lat": 50.368473380133,
                "lng": 30.456075668335,
                "desc": "–¢–µ—Ä–µ–º–∫–∏ 2, –æ–±–∞ –≤—ã–µ–∑–¥–∞ –Ω–∞ –æ–∫—Ä—É–∂–Ω—É—é, –õ—É—Ü–µ–Ω–∫–æ –∏ –ø–æ–∂–∞—Ä–∫–∞.",
                "time": "17:08"
            },
            {
                "id": 35,
                "type": 3,
                "lat": 50.403259133409,
                "lng": 30.684814453125,
                "desc": "–º–µ—Ç—Ä–æ –ë–æ—Ä–∏—Å–ø—ñ–ª—å—Å—å–∫–∞ –ø–æ–∫–∏ —â–æ –±–µ–∑ –æ–ø–∞–¥—ñ–≤",
                "time": "17:08"
            },
            {
                "id": 36,
                "type": 3,
                "lat": 50.397579545744,
                "lng": 30.636615157127,
                "desc": "–ü–æ–∑–Ω—è–∫–∏ –≤—Ö—ñ–¥ –≤—ñ–¥ –ê–ª–∞–¥—ñ–Ω—É –Ω–∞ 07:48",
                "time": "17:09"
            },
            {
                "id": 37,
                "type": 3,
                "lat": 50.368206488141,
                "lng": 30.455667972565,
                "desc": "üåû–ë–ü –û–¥–µ—Å—å–∫–∞ - —á–∏—Å—Ç–æ –∑ 2 —Å—Ç–æ—Ä—ñ–Ω 7:35",
                "time": "17:09"
            },
            {
                "id": 38,
                "type": 3,
                "lat": 50.57130668802,
                "lng": 30.490179955959,
                "desc": "–í–∏—à–≥–æ—Ä–æ–¥ –º–æ—Ç–æ —Å–æ–Ω—è—á–Ω–æ",
                "time": "17:10"
            },
            {
                "id": 39,
                "type": 2,
                "lat": 50.458572984297,
                "lng": 30.404282212257,
                "desc": "–ú–µ—Ç—Ä–æ –Ω–∏–≤–∫–∏",
                "time": "17:12"
            },
            {
                "id": 40,
                "type": 4,
                "lat": 50.505058063585,
                "lng": 30.43795466423,
                "desc": "–ë–ª–æ–∫–ø–æ—Å—Ç –Ω–∞ –°–≤–æ–±–æ–¥–∏ –±—ñ–ª—è –¢–¶ –û—Ä–Ω–∞–º–µ–Ω—Ç",
                "time": "17:13"
            },
            {
                "id": 41,
                "type": 1,
                "lat": 50.472419517921,
                "lng": 30.45156955719,
                "desc": "—Å—Ç–æ—è–ª–∏ 8:30 —É—Ö–∏–ª—è–Ω—Ç–∏ –∑ —á—É–ø–∞—á—É–ø—Å–æ–º –º–æ–∂–µ –Ω–µ –Ω–∞ –¥–æ–≤–≥–æ",
                "time": "17:15"
            },
            {
                "id": 42,
                "type": 1,
                "lat": 50.487924187712,
                "lng": 30.363560914993,
                "desc": "–õ–∞–≤—ñ–Ω–∞ –≤ –±—ñ–∫ –∞–∫–∞–¥–µ–º —è–∫ –∑–∞–≤–∂–¥–∏ –Ω–∞ —à–≤–∏–¥–∫—ñ—Å—Ç—å",
                "time": "17:16"
            },
            {
                "id": 43,
                "type": 1,
                "lat": 50.454723918191,
                "lng": 30.612523555756,
                "desc": "–ú.–¥–∞—Ä–Ω–∏—Ü–∞ –æ–¥–∏–Ω –º—É—Å–æ—Ä –≤–æ–∑–ª–µ —Ç—É—Ä–Ω–∏–∫–µ—Ç–æ–≤ –Ω–æ–≤—ã–π –≤—ã—Ö–æ–¥",
                "time": "17:17"
            },
            {
                "id": 44,
                "type": 2,
                "lat": 50.50461111252,
                "lng": 30.428770780563,
                "desc": "–ù–∞ –ü—Ä–∞–≤–¥–∏ 66 —Å—ñ—Ä–∞ –¥–∂–∏–ª—ñ –∑ –∫–æ–º–ø–ª–µ–∫—Ç–æ–º üêì",
                "time": "17:21"
            },
            {
                "id": 45,
                "type": 2,
                "lat": 50.482456146336,
                "lng": 30.634667873383,
                "desc": "–õ–µ—Å–Ω–æ–π –ø—Ä–æ—Å–ø–µ–∫—Ç , –∏ –ö—É–±–∞–Ω—Å–∫–æ–π –£–∫—Ä–∞–∏–Ω—ã —Å–Ω–æ–≤–∞ –æ—á–µ–Ω—å –º–Ω–æ–≥–æ –º–∞—à–∏–Ω , –µ–∑–¥—è—Ç –ø–æ –¥–≤–æ—Ä–∞–º ... –î–∂–∏–ª–∏ , –∫–∞–º—É—Ñ–ª—è–∂–Ω–∞—è , –¥–∂–∏–ø –º—É—Å–æ—Ä–æ–≤–æ–∑–æ–≤ –∏ –æ–±—ã—á–Ω—ã–π –±–µ–ª—ã–π –ø–∏—Ä–æ",
                "time": "17:23"
            },
            {
                "id": 46,
                "type": 2,
                "lat": 50.509974246101,
                "lng": 30.232207775116,
                "desc": "–ü—Ä–∏—É—Å + –±—É—Å –ò—Ä–ø–µ–Ω—å —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç—Å–∫–∞—è –ø–æ–µ—Ö–∞–ª–∏ –≤ —Å—Ç–æ—Ä–æ–Ω—É –Ω–∞–ª–æ–≥–æ–≤–æ–π",
                "time": "17:24"
            },
            {
                "id": 47,
                "type": 3,
                "lat": 50.462250991726,
                "lng": 30.48184633255,
                "desc": "–º–µ—Ç—Ä–æ –õ—É–∫&#039;—è–Ω—ñ–≤—Å—å–∫–∞ –≤ —Å–µ—Ä–µ–¥–∏–Ω—ñ —Ç–∞ –∫–æ–ª–æ –≤—Ö–æ–¥—É —á–∏—Å—Ç–æ",
                "time": "17:26"
            },
            {
                "id": 48,
                "type": 2,
                "lat": 50.507470161575,
                "lng": 30.409598350525,
                "desc": "–¢—Ä–æ—î –ø—Ä–æ–∫–ª—è—Ç–∏—Ö —ó–∑–¥—è—Ç—å –Ω–∞ —Å—ñ—Ä—ñ –î–∂–∏–ª—ñ –°–ö, –Ω–æ–º–µ—Ä 8260, –ø–æ –ì–æ–Ω–≥–∞–¥–∑–µ, –≤–∏—Å–∫–∞–∫—É—é—Ç—å –Ω–∞ –ø—Ä–æ—Ö–æ–∂–∏—Ö.",
                "time": "17:29"
            },
            {
                "id": 49,
                "type": 2,
                "lat": 50.116478007782,
                "lng": 30.633364319801,
                "desc": "–û–±—É—Ö–æ–≤ –≤—Ç–æ—Ä—Ä–µ—Å—É—Ä—Å—ã –¥–æ–∂–¥—å. –ò –≤—ã–µ–∑–¥ –∏–∑ –ó–µ–ª–µ–Ω–æ–≥–æ –≥–∞—è —Ç–æ–∂–µ –≥—Ä–æ–∑–∞",
                "time": "17:30"
            },
            {
                "id": 50,
                "type": 2,
                "lat": 50.499863275779,
                "lng": 30.502528846264,
                "desc": "–ô–æ—Ä–¥–∞–Ω—Å—å–∫–∞ 17–∞, –±—ñ–ª—è 1–≥–æ –ø—ñ–¥&#039;—ó–∑–¥—É. –ú–∞—à–∏–Ω–∞ –ö–æ–º—Å–µ—Ä–≤—ñ—Å 2+1 –∑—É–ø–∏–Ω—è—é—Ç—å –≤—Å—ñ—Ö —Ö—Ç–æ —Ä—É—Ö–∞—î—Ç—å—Å—è –≤ —Å—Ç–æ—Ä–æ–Ω—É –º–µ—Ç—Ä–æ –û–±–æ–ª–æ–Ω—å",
                "time": "17:31"
            },
            {
                "id": 51,
                "type": 2,
                "lat": 50.390770666345,
                "lng": 30.368260145187,
                "desc": "–í–∏—à–Ω–µ–≤–µ,—Å–≤—è—Ç–æ—à–∏–Ω—Å–∫–∞ –∫—É—Ä—Å—É—î –∑–µ–ª–µ–Ω–∏–π –ø—ñ–∫–∞–ø —ñ–∑ –∑–µ–ª–µ–Ω–∏–º–∏ –ø–æ–≤—ñ–ª—å–Ω–æ, —à—É–∫–∞—é—Ç—å 8:40",
                "time": "17:33"
            },
            {
                "id": 52,
                "type": 3,
                "lat": 50.395414900059,
                "lng": 30.616536140442,
                "desc": "–º. –û—Å–æ–∫–æ—Ä–∫–∏. 9:00. –í–∏—Ö—ñ–¥ –≤ —Å—Ç–æ—Ä–æ–Ω—É –ü–æ–∑–Ω—è–∫—ñ–≤. –í—Å–µ –¥–æ–±—Ä–µ.",
                "time": "17:33"
            },
            {
                "id": 53,
                "type": 3,
                "lat": 50.438019373568,
                "lng": 30.521349906921,
                "desc": "–ü–∞–ª–∞—Ü —É–∫—Ä–∞–∏–Ω—ã —á–∏—Å—Ç–æ 8:47",
                "time": "17:34"
            },
            {
                "id": 54,
                "type": 2,
                "lat": 50.520050649588,
                "lng": 30.502558350563,
                "desc": "–ì–µ—Ä–æ–µ–≤ –î–Ω–µ–ø—Ä–∞ 32, –∫–æ–º—Å–µ—Ä–≤–∏—Å –ø–æ –¥–≤–æ—Ä–∞–º –µ–∑–¥—è—Ç",
                "time": "17:35"
            },
            {
                "id": 55,
                "type": 2,
                "lat": 50.417569633082,
                "lng": 30.641899108887,
                "desc": "—Ö–∞—Ä—å–∫–æ–≤—Å–∫–∞—è, –æ–∑–µ—Ä–æ –°–æ–ª–Ω–µ—á–Ω–æ–µ, –∑–∞–≥—Ä–µ–±–ª–∏ –≤ 09:00",
                "time": "17:37"
            },
            {
                "id": 56,
                "type": 2,
                "lat": 50.52581444941,
                "lng": 30.628101825714,
                "desc": "–ó–∞–∫—Ä–µ–≤—Å–∫–æ–≥–æ 87, —Å–µ—Ä–∞—è –î–∂–∏–ª–∏, –ø–æ–ª–Ω—ã–π –∫–æ–º–ø–ª–µ–∫—Ç –≤–æ–∑–ª–µ –æ—Ç–¥–µ–ª–µ–Ω–∏—è –Ω–æ–≤–æ–π –ø–æ—á—Ç—ã –Ω–∞ 9:30",
                "time": "17:39"
            },
            {
                "id": 57,
                "type": 1,
                "lat": 50.475376106752,
                "lng": 30.432225465775,
                "desc": "–ø–µ—Ä–µ–∫—Ä–µ—Å—Ç–æ–∫ –©—É—Å–µ–≤–∞ –∏ –†–∏–∂—Å–∫–æ–π —Å—Ç–æ—è—Ç –≤ —á–µ—Ä–Ω–æ–º ~ 9.30.",
                "time": "17:42"
            },
            {
                "id": 58,
                "type": 2,
                "lat": 50.532921029773,
                "lng": 30.609691143036,
                "desc": "–¢—Ä–æ–µ—â–∏–Ω–∞, —É–ª–∏—Ü–∞ –ú–∏–ª–æ—Å–ª–∞–≤—Å–∫–∞—è. –ï–∑–¥–∏—Ç –∫–∞–º—É—Ñ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∏—Ä–æ–∂–æ–∫. –í —Å—Ä–µ–¥–∏–Ω–µ —Ç–≤–∞—Ä–∏ –¥–≤—É—Ö –º–∞—Å—Ç–µ–π. –ó–∞–µ—Ö–∞–ª–∏ –Ω–∞ –∑–∞–ø—Ä–∞–≤–∫—É –û–ö–ö–û. 9:25",
                "time": "17:42"
            },
            {
                "id": 59,
                "type": 2,
                "lat": 50.376609443697,
                "lng": 30.330601930618,
                "desc": "–°–≤—è—Ç–æ–ø–µ—Ç—Ä—ñ–≤—Å—å–∫–µ –∞—Ç–± –∑–µ–ª–µ–Ω–∏–π –¥–∂–∞–∫—Å—Ç–µ—Ä",
                "time": "17:44"
            },
            {
                "id": 60,
                "type": 1,
                "lat": 50.441678480611,
                "lng": 30.625296235085,
                "desc": "–°–æ–±–æ—Ä–Ω–æ—Å—Ç–∏ 1 –≤–æ–∑–ª–µ –∞–≤—Ä–æ—Ä—ã 2üçÜ —Ç–æ—Ä–º–æ–∑—è—Ç —Å –ø–ª–∞–Ω—à–µ—Ç–æ–º –ø–µ—Ä–µ—Ö–æ–∂–∏—Ö",
                "time": "17:45"
            },
            {
                "id": 61,
                "type": 3,
                "lat": 50.473621294577,
                "lng": 30.671467781067,
                "desc": "–ë–∏–∫–æ–≤–Ω—è",
                "time": "17:45"
            },
            {
                "id": 62,
                "type": 3,
                "lat": 50.464593566014,
                "lng": 30.646072626114,
                "desc": "–≤–∏—Ö—ñ–¥ –Ω–∞ –±–∞–∑–∞—Ä",
                "time": "17:46"
            },
            {
                "id": 63,
                "type": 2,
                "lat": 50.514954727888,
                "lng": 30.455474853516,
                "desc": "–î–∂–∏–ª—ñ",
                "time": "17:48"
            },
            {
                "id": 64,
                "type": 4,
                "lat": 50.506426185207,
                "lng": 30.450775623322,
                "desc": "–ë–ü –Ω–∞ 11:25",
                "time": "17:53"
            },
            {
                "id": 65,
                "type": 2,
                "lat": 50.439577347281,
                "lng": 30.516865253448,
                "desc": "11:20 –ü–ª.—É–∫—Ä.–≥–µ—Ä–æ–µ–≤ (–º–∞–∫, –ø—å—è–Ω–∞—è –≤–∏—à–Ω—è) —à–Ω—ã—Ä—è—é—Ç –∑–µ–ª–µ–Ω—ã–µ –ø–∏–¥–æ—Ä—ã, —Ä—è–¥–æ–º –∫—Ä–∞—Å–Ω—ã–π –±—É—Å–∏–∫",
                "time": "17:54"
            },
            {
                "id": 66,
                "type": 1,
                "lat": 50.29734495229,
                "lng": 30.532947778702,
                "desc": "–î–≤–∞ üëÆüëÆ‚Äç‚ôÇÔ∏è (–õ—ñ—Å–Ω–∏–∫–∏ –ê–¢–ë –°–Ü–õ–¨–ü–û ) 11:30",
                "time": "17:56"
            },
            {
                "id": 67,
                "type": 2,
                "lat": 50.548726263039,
                "lng": 30.216994285583,
                "desc": "‚õàÔ∏è‚õàÔ∏è‚õàÔ∏è‚õàÔ∏è‚õàÔ∏è",
                "time": "17:57"
            },
            {
                "id": 68,
                "type": 2,
                "lat": 50.529688418634,
                "lng": 30.656576156616,
                "desc": "–¢–µ—Ü6.  —Å–∏–Ω—ñ–π, —Ç–æ–π —â–æ &quot;–ø–æ—Å—Ç—ñ–π–Ω–æ —Å—Ç–æ—ó—Ç—å&quot; –∑—É–ø–∏–Ω—è—î –≤–∏–±—ñ—Ä–∫–æ–≤–æ –∑ –ü–æ–≥—Ä–µ–±—ñ–≤",
                "time": "17:58"
            },
            {
                "id": 69,
                "type": 2,
                "lat": 50.423619356466,
                "lng": 30.601569414139,
                "desc": "–° —Ç—ã–ª—å–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω—ã –¥–æ–º–∞, –∑–µ–ª—ë–Ω—ã–µ –∏ —Å–∏–Ω–∏–µ –æ—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ –º—É–∂–∏–∫–∞ —Å –∂–µ–Ω—â–∏–Ω–æ–π.",
                "time": "18:00"
            },
            {
                "id": 70,
                "type": 3,
                "lat": 50.413002776452,
                "lng": 30.52426815033,
                "desc": "–ü–µ—Ä–µ—Ö–æ–¥ —á–∏—Å—Ç–æ",
                "time": "18:00"
            }
        ];

        var map = L.map('map').setView([50.4447569069039, 30.54741427671182], 10);

        var marker;

        var IconClass = L.Icon.extend({
            options: {
                shadowUrl:    'assets/icon_shadow_32.png',
                iconSize:     [32, 32],
                shadowSize:   [32, 20],
                iconAnchor:   [16, 32],
                shadowAnchor: [0, 16],
                popupAnchor:  [0, -32]
            }
        });

        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ –º–∞—Ä–∫–µ—Ä–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞
        const eventAdditionalProps = {
            1: {
                'iconSrc': 'assets/police_one.png',
            },
            2: {
                'iconSrc': 'assets/icons8-soldiers-64.png',
            },
            3: {
                'iconSrc': 'assets/sun.png',
            },
            4: {
                'iconSrc': 'assets/stop_control.png',
            },
        };

        // –ö–∞—Å—Ç–æ–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–∫–æ–Ω–∫–∏ —Å–æ–±—ã—Ç–∏–π
        const markerIconsArr = {
            1: new IconClass({iconUrl: eventAdditionalProps[1].iconSrc}),
            2: new IconClass({iconUrl: eventAdditionalProps[2].iconSrc}),
            3: new IconClass({iconUrl: eventAdditionalProps[3].iconSrc}),
            4: new IconClass({iconUrl: eventAdditionalProps[4].iconSrc})
        };

        L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
        }).addTo(map);

/*        var circle = L.circle([50.511243, 30.513486], {
            color: 'red',
            alt: "Test",
            fillColor: '#f03',
            fillOpacity: 0.5,
            radius: 250
        })*/
        // .bindPopup("<b>Hello world!</b><br>I am a popup.").openPopup()
        // .bindTooltip("<b>Hello world!</b><br>I am a popup.")
/*        .on("click", function(e) {
            $("#rating").addClass("font-green");
            $("#reportInfoDetailsPopup").show();
            map.panTo(e.latlng);
        })
        .addTo(map);*/

        /**
         * –†–∞–∑–º–µ—Å—Ç–∏—Ç—å —Ç–æ—á–∫–∏ –Ω–∞ –∫–∞—Ä—Ç–µ
         *
         * @param markersArr
         */
        function placeMarkersOnMap(markersArr) {
            for (let i = 0; i < markersArr.length; i++) {
                let item = L.marker([markersArr[i].lat, markersArr[i].lng], {icon: markerIconsArr[markersArr[i].type]})
                .on("click", function(e) {
                    $("#reportInfoDetailsPopup").hide();
                    $("#reportInfoDetailsPopup .icon > img").attr('src', eventAdditionalProps[markersArr[i].type].iconSrc);
                    $("#reportInfoDetailsPopup .time").text(markersArr[i].time);
                    $("#reportInfoDetailsPopup .status").text(i18n[userSettings.currentLang][0].EVENT_TYPE[markersArr[i].type]);
                    $("#reportInfoDetailsPopup .description").text(markersArr[i].desc);

                    // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –±–ª–æ–∫ —Ä–µ–π—Ç–∏–Ω–≥
                    $("#rating").removeClass("font-normal font-green font-red");
                    if ( markersArr[i].rating > 0) {
                        $("#rating").addClass("font-green");
                    } else {
                        if ( markersArr[i].rating < 0 ) {
                            $("#rating").addClass("font-red");
                        } else {
                            $("#rating").addClass("font-normal");
                        }
                    }
                    $("#rating").text(markersArr[i].rating);

                    $("#reportInfoDetailsPopup").show();
                    map.panTo(e.latlng);

                    Telegram.WebApp.MainButton.hide();
                    Telegram.WebApp.SecondaryButton.hide();

                    // Show Telegram buttons
                    /*Telegram.WebApp.MainButton.setParams({
                        text: '–ê–∫—Ç—É–∞–ª—å–Ω–æ'
                    });
                    Telegram.WebApp.MainButton.show();

                    Telegram.WebApp.SecondaryButton.setParams({
                        text: '–ù–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ'
                    });
                    Telegram.WebApp.SecondaryButton.show();*/
                })
                .addTo(map);
            }
        }

        function onMapClick(e) {
            // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Å—Ç–æ –Ω–∞–∂–∞–ª –Ω–∞ –∫–∞—Ä—Ç—É - –≤—ã—Ö–æ–¥–∏–º
            if ( !isAddNewMarketBtnClicked )
                return false;

            marker = new L.marker(e.latlng, {draggable: 'true'});
            marker.on('dragend', function (event) {
                var marker = event.target;
                var position = marker.getLatLng();
                marker.setLatLng(new L.LatLng(position.lat, position.lng), {draggable: 'true'});
                map.panTo(new L.LatLng(position.lat, position.lng))
            });
            map.addLayer(marker); // –î–æ–±–∞–≤–ª—è–µ–º –º–µ—Ç–∫—É –Ω–∞ –∫–∞—Ä—Ç–µ

            // –ü—Ä—è—á–µ–º –≤–µ—Ä—Ö–Ω—é—é –ø–∞–Ω–µ–ª—å —Å –∫–Ω–æ–ø–∫–∞–º–∏
            $("#topPanel").hide();

            // –û—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª —ç–∫—Ä–∞–Ω–∞ –ø–æ–¥ –æ–ø–∏—Å–∞–Ω–∏–µ
            $("#reportInfoModal").show();

            map.panTo(marker.getLatLng()); // –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –∫–∞—Ä—Ç—É –ø–æ —Å–µ—Ä–µ–¥–∏–Ω–µ –º–µ—Ç–∫–∏

            $("#setMapMarkerHint").hide(); // –ü—Ä—è—á–µ–º –Ω–∞–¥–ø–∏—Å—å –æ —Ä–∞–∑–º–µ—â–µ–Ω–∏–∏ —Ç–æ—á–∫–∏

            isAddNewMarketBtnClicked = false;
            setPressedBtn("#addNewMarkerBtn", false);

            // –ü—Ä—è—á–µ–º –∫–Ω–æ–ø–∫–∏ Telegram
            Telegram.WebApp.MainButton.hide();
        };

        map.on('click', onMapClick);
    </script>
    <!-- End of Map Script -->

    <!-- Eruda is console for mobile browsers -->
<!--    <script src="https://cdn.jsdelivr.net/npm/eruda"></script>
    <script>eruda.init();</script>-->

</body>
</html>
